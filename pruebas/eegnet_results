{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/dannasalazar11/eegnet-results?scriptVersionId=202877132\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"c2863a63","metadata":{"papermill":{"duration":0.006635,"end_time":"2024-10-23T16:07:17.05204","exception":false,"start_time":"2024-10-23T16:07:17.045405","status":"completed"},"tags":[]},"source":["# **EEGNet cross-validation**"]},{"cell_type":"markdown","id":"c9833364","metadata":{"papermill":{"duration":0.005729,"end_time":"2024-10-23T16:07:17.064133","exception":false,"start_time":"2024-10-23T16:07:17.058404","status":"completed"},"tags":[]},"source":["En este cuaderno hacemos cross-validation de todos los sujetos de la EEGNet para poder hacer un marco comparativo con la GMRRNet."]},{"cell_type":"markdown","id":"5dcdc2df","metadata":{"papermill":{"duration":0.005689,"end_time":"2024-10-23T16:07:17.075853","exception":false,"start_time":"2024-10-23T16:07:17.070164","status":"completed"},"tags":[]},"source":["## **Instalación de repositorios e importación de librerías**"]},{"cell_type":"code","execution_count":1,"id":"3750760b","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2024-10-23T16:07:17.090994Z","iopub.status.busy":"2024-10-23T16:07:17.09Z","iopub.status.idle":"2024-10-23T16:08:55.006802Z","shell.execute_reply":"2024-10-23T16:08:55.005378Z"},"papermill":{"duration":97.927353,"end_time":"2024-10-23T16:08:55.009616","exception":false,"start_time":"2024-10-23T16:07:17.082263","status":"completed"},"scrolled":true,"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting git+https://github.com/UN-GCPDS/python-gcpds.databases\r\n","  Cloning https://github.com/UN-GCPDS/python-gcpds.databases to /tmp/pip-req-build-tfje9rp6\r\n","  Running command git clone --filter=blob:none --quiet https://github.com/UN-GCPDS/python-gcpds.databases /tmp/pip-req-build-tfje9rp6\r\n","  Resolved https://github.com/UN-GCPDS/python-gcpds.databases to commit c35637e1a19d7cd21656496339c1dedae6714916\r\n","  Preparing metadata (setup.py) ... \u001b[?25ldone\r\n","\u001b[?25hRequirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (1.26.4)\r\n","Requirement already satisfied: scipy in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (1.11.4)\r\n","Requirement already satisfied: matplotlib in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (3.7.5)\r\n","Requirement already satisfied: mne in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (1.7.0)\r\n","Requirement already satisfied: tables in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (3.9.2)\r\n","Requirement already satisfied: tqdm in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (4.66.4)\r\n","Requirement already satisfied: pandas in /opt/conda/lib/python3.10/site-packages (from gcpds-databases==0.2) (2.2.1)\r\n","Collecting gdown (from gcpds-databases==0.2)\r\n","  Downloading gdown-5.2.0-py3-none-any.whl.metadata (5.8 kB)\r\n","Requirement already satisfied: beautifulsoup4 in /opt/conda/lib/python3.10/site-packages (from gdown->gcpds-databases==0.2) (4.12.2)\r\n","Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from gdown->gcpds-databases==0.2) (3.13.1)\r\n","Requirement already satisfied: requests[socks] in /opt/conda/lib/python3.10/site-packages (from gdown->gcpds-databases==0.2) (2.32.3)\r\n","Requirement already satisfied: contourpy>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (1.2.0)\r\n","Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (0.12.1)\r\n","Requirement already satisfied: fonttools>=4.22.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (4.47.0)\r\n","Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (1.4.5)\r\n","Requirement already satisfied: packaging>=20.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (21.3)\r\n","Requirement already satisfied: pillow>=6.2.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (9.5.0)\r\n","Requirement already satisfied: pyparsing>=2.3.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (3.1.1)\r\n","Requirement already satisfied: python-dateutil>=2.7 in /opt/conda/lib/python3.10/site-packages (from matplotlib->gcpds-databases==0.2) (2.9.0.post0)\r\n","Requirement already satisfied: decorator in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-databases==0.2) (5.1.1)\r\n","Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-databases==0.2) (3.1.2)\r\n","Requirement already satisfied: lazy-loader>=0.3 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-databases==0.2) (0.3)\r\n","Requirement already satisfied: pooch>=1.5 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-databases==0.2) (1.8.1)\r\n","Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas->gcpds-databases==0.2) (2023.3.post1)\r\n","Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas->gcpds-databases==0.2) (2023.4)\r\n","Requirement already satisfied: numexpr>=2.6.2 in /opt/conda/lib/python3.10/site-packages (from tables->gcpds-databases==0.2) (2.10.0)\r\n","Requirement already satisfied: py-cpuinfo in /opt/conda/lib/python3.10/site-packages (from tables->gcpds-databases==0.2) (9.0.0)\r\n","Requirement already satisfied: blosc2>=2.3.0 in /opt/conda/lib/python3.10/site-packages (from tables->gcpds-databases==0.2) (2.6.2)\r\n","Requirement already satisfied: ndindex>=1.4 in /opt/conda/lib/python3.10/site-packages (from blosc2>=2.3.0->tables->gcpds-databases==0.2) (1.8)\r\n","Requirement already satisfied: msgpack in /opt/conda/lib/python3.10/site-packages (from blosc2>=2.3.0->tables->gcpds-databases==0.2) (1.0.7)\r\n","Requirement already satisfied: platformdirs>=2.5.0 in /opt/conda/lib/python3.10/site-packages (from pooch>=1.5->mne->gcpds-databases==0.2) (3.11.0)\r\n","Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib->gcpds-databases==0.2) (1.16.0)\r\n","Requirement already satisfied: soupsieve>1.2 in /opt/conda/lib/python3.10/site-packages (from beautifulsoup4->gdown->gcpds-databases==0.2) (2.5)\r\n","Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->mne->gcpds-databases==0.2) (2.1.3)\r\n","Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown->gcpds-databases==0.2) (3.3.2)\r\n","Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown->gcpds-databases==0.2) (3.6)\r\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown->gcpds-databases==0.2) (1.26.18)\r\n","Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown->gcpds-databases==0.2) (2024.2.2)\r\n","Requirement already satisfied: PySocks!=1.5.7,>=1.5.6 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown->gcpds-databases==0.2) (1.7.1)\r\n","Downloading gdown-5.2.0-py3-none-any.whl (18 kB)\r\n","Building wheels for collected packages: gcpds-databases\r\n","  Building wheel for gcpds-databases (setup.py) ... \u001b[?25l-\b \bdone\r\n","\u001b[?25h  Created wheel for gcpds-databases: filename=gcpds_databases-0.2-py3-none-any.whl size=94504 sha256=980d29a0826f9eb87d641ed6f5554755719d1ff66bc6e8e3c235ccd188a766e7\r\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-c99j9vx_/wheels/8e/66/a7/91b78b1787a3e4d17cb82ea2da67845aa9389012c0ed8280b0\r\n","Successfully built gcpds-databases\r\n","Installing collected packages: gdown, gcpds-databases\r\n","Successfully installed gcpds-databases-0.2 gdown-5.2.0\r\n","Collecting git+https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models\r\n","  Cloning https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models to /tmp/pip-req-build-94w3t0a1\r\n","  Running command git clone --filter=blob:none --quiet https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models /tmp/pip-req-build-94w3t0a1\r\n","  Resolved https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models to commit 975885b1f6814fd5958199919b33e02a6a9aa152\r\n","  Preparing metadata (setup.py) ... \u001b[?25ldone\r\n","\u001b[?25hCollecting braindecode==0.7 (from EEG_Tensorflow_models==0.2)\r\n","  Downloading Braindecode-0.7-py3-none-any.whl.metadata (6.8 kB)\r\n","Collecting moabb (from EEG_Tensorflow_models==0.2)\r\n","  Downloading moabb-1.1.1-py3-none-any.whl.metadata (16 kB)\r\n","Collecting tensorflow-addons (from EEG_Tensorflow_models==0.2)\r\n","  Downloading tensorflow_addons-0.23.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.8 kB)\r\n","Requirement already satisfied: tensorflow>=2.8 in /opt/conda/lib/python3.10/site-packages (from EEG_Tensorflow_models==0.2) (2.15.0)\r\n","Collecting tf-keras-vis (from EEG_Tensorflow_models==0.2)\r\n","  Downloading tf_keras_vis-0.8.7-py3-none-any.whl.metadata (10 kB)\r\n","Requirement already satisfied: mne in /opt/conda/lib/python3.10/site-packages (from braindecode==0.7->EEG_Tensorflow_models==0.2) (1.7.0)\r\n","Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from braindecode==0.7->EEG_Tensorflow_models==0.2) (1.26.4)\r\n","Requirement already satisfied: pandas in /opt/conda/lib/python3.10/site-packages (from braindecode==0.7->EEG_Tensorflow_models==0.2) (2.2.1)\r\n","Requirement already satisfied: scipy in /opt/conda/lib/python3.10/site-packages (from braindecode==0.7->EEG_Tensorflow_models==0.2) (1.11.4)\r\n","Requirement already satisfied: matplotlib in /opt/conda/lib/python3.10/site-packages (from braindecode==0.7->EEG_Tensorflow_models==0.2) (3.7.5)\r\n","Requirement already satisfied: h5py in /opt/conda/lib/python3.10/site-packages (from braindecode==0.7->EEG_Tensorflow_models==0.2) (3.10.0)\r\n","Collecting skorch (from braindecode==0.7->EEG_Tensorflow_models==0.2)\r\n","  Downloading skorch-1.0.0-py3-none-any.whl.metadata (11 kB)\r\n","Requirement already satisfied: absl-py>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.4.0)\r\n","Requirement already satisfied: astunparse>=1.6.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.6.3)\r\n","Requirement already satisfied: flatbuffers>=23.5.26 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (23.5.26)\r\n","Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.5.4)\r\n","Requirement already satisfied: google-pasta>=0.1.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.2.0)\r\n","Requirement already satisfied: libclang>=13.0.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (16.0.6)\r\n","Requirement already satisfied: ml-dtypes~=0.2.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.2.0)\r\n","Requirement already satisfied: opt-einsum>=2.3.2 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (3.3.0)\r\n","Requirement already satisfied: packaging in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (21.3)\r\n","Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (3.20.3)\r\n","Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (69.0.3)\r\n","Requirement already satisfied: six>=1.12.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.16.0)\r\n","Requirement already satisfied: termcolor>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (2.4.0)\r\n","Requirement already satisfied: typing-extensions>=3.6.6 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (4.9.0)\r\n","Requirement already satisfied: wrapt<1.15,>=1.11.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.14.1)\r\n","Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.35.0)\r\n","Requirement already satisfied: grpcio<2.0,>=1.24.3 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.59.3)\r\n","Requirement already satisfied: tensorboard<2.16,>=2.15 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (2.15.1)\r\n","Requirement already satisfied: tensorflow-estimator<2.16,>=2.15.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow>=2.8->EEG_Tensorflow_models==0.2) (2.15.0)\r\n","Collecting keras<2.16,>=2.15.0 (from tensorflow>=2.8->EEG_Tensorflow_models==0.2)\r\n","  Downloading keras-2.15.0-py3-none-any.whl.metadata (2.4 kB)\r\n","Requirement already satisfied: PyYAML<7.0,>=6.0 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (6.0.1)\r\n","Collecting coverage<8.0.0,>=7.0.1 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading coverage-7.6.4-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.2 kB)\r\n","Collecting edfio<0.5.0,>=0.4.2 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading edfio-0.4.4-py3-none-any.whl.metadata (4.0 kB)\r\n","Collecting edflib-python<2.0.0,>=1.0.6 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading EDFlib_Python-1.0.8-py3-none-any.whl.metadata (1.3 kB)\r\n","Requirement already satisfied: memory-profiler<0.62.0,>=0.61.0 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (0.61.0)\r\n","Collecting mne-bids<0.15,>=0.14 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading mne_bids-0.14-py2.py3-none-any.whl.metadata (4.8 kB)\r\n","Collecting pandas (from braindecode==0.7->EEG_Tensorflow_models==0.2)\r\n","  Downloading pandas-1.5.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)\r\n","Requirement already satisfied: pooch<2.0.0,>=1.6.0 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (1.8.1)\r\n","Collecting pyriemann<0.7,>=0.6 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading pyriemann-0.6-py2.py3-none-any.whl.metadata (8.3 kB)\r\n","Collecting pytest<8.0.0,>=7.4.0 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading pytest-7.4.4-py3-none-any.whl.metadata (7.9 kB)\r\n","Requirement already satisfied: requests<3.0.0,>=2.28.1 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (2.32.3)\r\n","Collecting scikit-learn>=1.4.2 (from moabb->EEG_Tensorflow_models==0.2)\r\n","  Downloading scikit_learn-1.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (13 kB)\r\n","Requirement already satisfied: seaborn<0.13.0,>=0.12.1 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (0.12.2)\r\n","Requirement already satisfied: tqdm<5.0.0,>=4.64.1 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (4.66.4)\r\n","Requirement already satisfied: urllib3<2.0.0,>=1.26.15 in /opt/conda/lib/python3.10/site-packages (from moabb->EEG_Tensorflow_models==0.2) (1.26.18)\r\n","Collecting typeguard<3.0.0,>=2.7 (from tensorflow-addons->EEG_Tensorflow_models==0.2)\r\n","  Downloading typeguard-2.13.3-py3-none-any.whl.metadata (3.6 kB)\r\n","Requirement already satisfied: pillow in /opt/conda/lib/python3.10/site-packages (from tf-keras-vis->EEG_Tensorflow_models==0.2) (9.5.0)\r\n","Requirement already satisfied: deprecated in /opt/conda/lib/python3.10/site-packages (from tf-keras-vis->EEG_Tensorflow_models==0.2) (1.2.14)\r\n","Requirement already satisfied: imageio in /opt/conda/lib/python3.10/site-packages (from tf-keras-vis->EEG_Tensorflow_models==0.2) (2.33.1)\r\n","Requirement already satisfied: wheel<1.0,>=0.23.0 in /opt/conda/lib/python3.10/site-packages (from astunparse>=1.6.0->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.42.0)\r\n","Requirement already satisfied: contourpy>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib->braindecode==0.7->EEG_Tensorflow_models==0.2) (1.2.0)\r\n","Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.10/site-packages (from matplotlib->braindecode==0.7->EEG_Tensorflow_models==0.2) (0.12.1)\r\n","Requirement already satisfied: fonttools>=4.22.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib->braindecode==0.7->EEG_Tensorflow_models==0.2) (4.47.0)\r\n","Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib->braindecode==0.7->EEG_Tensorflow_models==0.2) (1.4.5)\r\n","Requirement already satisfied: pyparsing>=2.3.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib->braindecode==0.7->EEG_Tensorflow_models==0.2) (3.1.1)\r\n","Requirement already satisfied: python-dateutil>=2.7 in /opt/conda/lib/python3.10/site-packages (from matplotlib->braindecode==0.7->EEG_Tensorflow_models==0.2) (2.9.0.post0)\r\n","Requirement already satisfied: psutil in /opt/conda/lib/python3.10/site-packages (from memory-profiler<0.62.0,>=0.61.0->moabb->EEG_Tensorflow_models==0.2) (5.9.3)\r\n","Requirement already satisfied: decorator in /opt/conda/lib/python3.10/site-packages (from mne->braindecode==0.7->EEG_Tensorflow_models==0.2) (5.1.1)\r\n","Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from mne->braindecode==0.7->EEG_Tensorflow_models==0.2) (3.1.2)\r\n","Requirement already satisfied: lazy-loader>=0.3 in /opt/conda/lib/python3.10/site-packages (from mne->braindecode==0.7->EEG_Tensorflow_models==0.2) (0.3)\r\n","Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas->braindecode==0.7->EEG_Tensorflow_models==0.2) (2023.3.post1)\r\n","Requirement already satisfied: platformdirs>=2.5.0 in /opt/conda/lib/python3.10/site-packages (from pooch<2.0.0,>=1.6.0->moabb->EEG_Tensorflow_models==0.2) (3.11.0)\r\n","Requirement already satisfied: joblib in /opt/conda/lib/python3.10/site-packages (from pyriemann<0.7,>=0.6->moabb->EEG_Tensorflow_models==0.2) (1.4.2)\r\n","Requirement already satisfied: iniconfig in /opt/conda/lib/python3.10/site-packages (from pytest<8.0.0,>=7.4.0->moabb->EEG_Tensorflow_models==0.2) (2.0.0)\r\n","Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/conda/lib/python3.10/site-packages (from pytest<8.0.0,>=7.4.0->moabb->EEG_Tensorflow_models==0.2) (1.5.0)\r\n","Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/conda/lib/python3.10/site-packages (from pytest<8.0.0,>=7.4.0->moabb->EEG_Tensorflow_models==0.2) (1.2.0)\r\n","Requirement already satisfied: tomli>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from pytest<8.0.0,>=7.4.0->moabb->EEG_Tensorflow_models==0.2) (2.0.1)\r\n","Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3.0.0,>=2.28.1->moabb->EEG_Tensorflow_models==0.2) (3.3.2)\r\n","Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3.0.0,>=2.28.1->moabb->EEG_Tensorflow_models==0.2) (3.6)\r\n","Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3.0.0,>=2.28.1->moabb->EEG_Tensorflow_models==0.2) (2024.2.2)\r\n","Requirement already satisfied: threadpoolctl>=3.1.0 in /opt/conda/lib/python3.10/site-packages (from scikit-learn>=1.4.2->moabb->EEG_Tensorflow_models==0.2) (3.2.0)\r\n","Requirement already satisfied: google-auth<3,>=1.6.3 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (2.26.1)\r\n","Requirement already satisfied: google-auth-oauthlib<2,>=0.5 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.2.0)\r\n","Requirement already satisfied: markdown>=2.6.8 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (3.5.2)\r\n","Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.7.2)\r\n","Requirement already satisfied: werkzeug>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (3.0.3)\r\n","Requirement already satisfied: tabulate>=0.7.7 in /opt/conda/lib/python3.10/site-packages (from skorch->braindecode==0.7->EEG_Tensorflow_models==0.2) (0.9.0)\r\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (4.2.4)\r\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.3.0)\r\n","Requirement already satisfied: rsa<5,>=3.1.4 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (4.9)\r\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /opt/conda/lib/python3.10/site-packages (from google-auth-oauthlib<2,>=0.5->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (1.3.1)\r\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /opt/conda/lib/python3.10/site-packages (from werkzeug>=1.0.1->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (2.1.3)\r\n","Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /opt/conda/lib/python3.10/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (0.5.1)\r\n","Requirement already satisfied: oauthlib>=3.0.0 in /opt/conda/lib/python3.10/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<2,>=0.5->tensorboard<2.16,>=2.15->tensorflow>=2.8->EEG_Tensorflow_models==0.2) (3.2.2)\r\n","Downloading Braindecode-0.7-py3-none-any.whl (184 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m184.4/184.4 kB\u001b[0m \u001b[31m4.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading moabb-1.1.1-py3-none-any.whl (269 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m269.3/269.3 kB\u001b[0m \u001b[31m9.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading tensorflow_addons-0.23.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (611 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m611.8/611.8 kB\u001b[0m \u001b[31m22.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading tf_keras_vis-0.8.7-py3-none-any.whl (52 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m52.5/52.5 kB\u001b[0m \u001b[31m3.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading coverage-7.6.4-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (234 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m234.6/234.6 kB\u001b[0m \u001b[31m12.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading edfio-0.4.4-py3-none-any.whl (25 kB)\r\n","Downloading EDFlib_Python-1.0.8-py3-none-any.whl (26 kB)\r\n","Downloading keras-2.15.0-py3-none-any.whl (1.7 MB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m55.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading mne_bids-0.14-py2.py3-none-any.whl (1.2 MB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.2/1.2 MB\u001b[0m \u001b[31m46.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading pandas-1.5.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.1 MB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m12.1/12.1 MB\u001b[0m \u001b[31m76.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading pyriemann-0.6-py2.py3-none-any.whl (111 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m111.7/111.7 kB\u001b[0m \u001b[31m6.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading pytest-7.4.4-py3-none-any.whl (325 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m325.3/325.3 kB\u001b[0m \u001b[31m18.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading scikit_learn-1.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.3 MB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m13.3/13.3 MB\u001b[0m \u001b[31m74.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hDownloading typeguard-2.13.3-py3-none-any.whl (17 kB)\r\n","Downloading skorch-1.0.0-py3-none-any.whl (239 kB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m239.4/239.4 kB\u001b[0m \u001b[31m14.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hBuilding wheels for collected packages: EEG_Tensorflow_models\r\n","  Building wheel for EEG_Tensorflow_models (setup.py) ... \u001b[?25l-\b \bdone\r\n","\u001b[?25h  Created wheel for EEG_Tensorflow_models: filename=EEG_Tensorflow_models-0.2-py3-none-any.whl size=29376 sha256=9359a71a217c195fd6fb369b63972e3e3dff3fe7aca0c0bd338928271caf7dc9\r\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-8h6lmzsp/wheels/05/dc/8a/9d552a33fb901c0d7ab2a72746b5ea17643c570811c711d568\r\n","Successfully built EEG_Tensorflow_models\r\n","Installing collected packages: typeguard, keras, edflib-python, edfio, coverage, tf-keras-vis, tensorflow-addons, scikit-learn, pytest, pandas, skorch, pyriemann, mne-bids, braindecode, moabb, EEG_Tensorflow_models\r\n","  Attempting uninstall: typeguard\r\n","    Found existing installation: typeguard 4.1.5\r\n","    Uninstalling typeguard-4.1.5:\r\n","      Successfully uninstalled typeguard-4.1.5\r\n","  Attempting uninstall: keras\r\n","    Found existing installation: keras 3.3.3\r\n","    Uninstalling keras-3.3.3:\r\n","      Successfully uninstalled keras-3.3.3\r\n","  Attempting uninstall: scikit-learn\r\n","    Found existing installation: scikit-learn 1.2.2\r\n","    Uninstalling scikit-learn-1.2.2:\r\n","      Successfully uninstalled scikit-learn-1.2.2\r\n","  Attempting uninstall: pytest\r\n","    Found existing installation: pytest 8.2.1\r\n","    Uninstalling pytest-8.2.1:\r\n","      Successfully uninstalled pytest-8.2.1\r\n","  Attempting uninstall: pandas\r\n","    Found existing installation: pandas 2.2.1\r\n","    Uninstalling pandas-2.2.1:\r\n","      Successfully uninstalled pandas-2.2.1\r\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n","cudf 24.4.1 requires cubinlinker, which is not installed.\r\n","cudf 24.4.1 requires cupy-cuda11x>=12.0.0, which is not installed.\r\n","cudf 24.4.1 requires ptxcompiler, which is not installed.\r\n","cuml 24.4.0 requires cupy-cuda11x>=12.0.0, which is not installed.\r\n","dask-cudf 24.4.1 requires cupy-cuda11x>=12.0.0, which is not installed.\r\n","tensorflow-decision-forests 1.8.1 requires wurlitzer, which is not installed.\r\n","beatrix-jupyterlab 2023.128.151533 requires jupyterlab~=3.6.0, but you have jupyterlab 4.2.1 which is incompatible.\r\n","cudf 24.4.1 requires cuda-python<12.0a0,>=11.7.1, but you have cuda-python 12.5.0 which is incompatible.\r\n","cudf 24.4.1 requires pandas<2.2.2dev0,>=2.0, but you have pandas 1.5.3 which is incompatible.\r\n","dask-cudf 24.4.1 requires pandas<2.2.2dev0,>=2.0, but you have pandas 1.5.3 which is incompatible.\r\n","dask-expr 1.1.2 requires pandas>=2, but you have pandas 1.5.3 which is incompatible.\r\n","featuretools 1.31.0 requires pandas>=2.0.0, but you have pandas 1.5.3 which is incompatible.\r\n","libpysal 4.9.2 requires packaging>=22, but you have packaging 21.3 which is incompatible.\r\n","libpysal 4.9.2 requires shapely>=2.0.1, but you have shapely 1.8.5.post1 which is incompatible.\r\n","mizani 0.11.4 requires pandas>=2.1.0, but you have pandas 1.5.3 which is incompatible.\r\n","momepy 0.7.0 requires shapely>=2, but you have shapely 1.8.5.post1 which is incompatible.\r\n","osmnx 1.9.3 requires shapely>=2.0, but you have shapely 1.8.5.post1 which is incompatible.\r\n","plotnine 0.13.6 requires pandas<3.0.0,>=2.1.0, but you have pandas 1.5.3 which is incompatible.\r\n","pyldavis 3.4.1 requires pandas>=2.0.0, but you have pandas 1.5.3 which is incompatible.\r\n","rapids-dask-dependency 24.4.1a0 requires dask==2024.1.1, but you have dask 2024.5.2 which is incompatible.\r\n","rapids-dask-dependency 24.4.1a0 requires dask-expr==0.4.0, but you have dask-expr 1.1.2 which is incompatible.\r\n","spopt 0.6.0 requires shapely>=2.0.1, but you have shapely 1.8.5.post1 which is incompatible.\r\n","woodwork 0.31.0 requires pandas>=2.0.0, but you have pandas 1.5.3 which is incompatible.\r\n","xarray 2024.5.0 requires packaging>=23.1, but you have packaging 21.3 which is incompatible.\r\n","xarray 2024.5.0 requires pandas>=2.0, but you have pandas 1.5.3 which is incompatible.\r\n","ydata-profiling 4.6.4 requires numpy<1.26,>=1.16.0, but you have numpy 1.26.4 which is incompatible.\r\n","ydata-profiling 4.6.4 requires typeguard<5,>=4.1.2, but you have typeguard 2.13.3 which is incompatible.\u001b[0m\u001b[31m\r\n","\u001b[0mSuccessfully installed EEG_Tensorflow_models-0.2 braindecode-0.7 coverage-7.6.4 edfio-0.4.4 edflib-python-1.0.8 keras-2.15.0 mne-bids-0.14 moabb-1.1.1 pandas-1.5.3 pyriemann-0.6 pytest-7.4.4 scikit-learn-1.5.2 skorch-1.0.0 tensorflow-addons-0.23.0 tf-keras-vis-0.8.7 typeguard-2.13.3\r\n","Collecting git+https://github.com/UN-GCPDS/python-gcpds.visualizations.git\r\n","  Cloning https://github.com/UN-GCPDS/python-gcpds.visualizations.git to /tmp/pip-req-build-ok2wlnj8\r\n","  Running command git clone --filter=blob:none --quiet https://github.com/UN-GCPDS/python-gcpds.visualizations.git /tmp/pip-req-build-ok2wlnj8\r\n","  Resolved https://github.com/UN-GCPDS/python-gcpds.visualizations.git to commit 162dbeac141a7472d3b0bd7f005932241b4663a5\r\n","  Preparing metadata (setup.py) ... \u001b[?25ldone\r\n","\u001b[?25hCollecting python-circos (from gcpds-visualizations==0.6)\r\n","  Downloading python_circos-0.3.0-py3-none-any.whl.metadata (766 bytes)\r\n","Requirement already satisfied: matplotlib>=3.5.3 in /opt/conda/lib/python3.10/site-packages (from gcpds-visualizations==0.6) (3.7.5)\r\n","Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from gcpds-visualizations==0.6) (1.26.4)\r\n","Requirement already satisfied: mne in /opt/conda/lib/python3.10/site-packages (from gcpds-visualizations==0.6) (1.7.0)\r\n","Requirement already satisfied: contourpy>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (1.2.0)\r\n","Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (0.12.1)\r\n","Requirement already satisfied: fonttools>=4.22.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (4.47.0)\r\n","Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (1.4.5)\r\n","Requirement already satisfied: packaging>=20.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (21.3)\r\n","Requirement already satisfied: pillow>=6.2.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (9.5.0)\r\n","Requirement already satisfied: pyparsing>=2.3.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (3.1.1)\r\n","Requirement already satisfied: python-dateutil>=2.7 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.5.3->gcpds-visualizations==0.6) (2.9.0.post0)\r\n","Requirement already satisfied: decorator in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-visualizations==0.6) (5.1.1)\r\n","Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-visualizations==0.6) (3.1.2)\r\n","Requirement already satisfied: lazy-loader>=0.3 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-visualizations==0.6) (0.3)\r\n","Requirement already satisfied: pooch>=1.5 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-visualizations==0.6) (1.8.1)\r\n","Requirement already satisfied: scipy>=1.7.1 in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-visualizations==0.6) (1.11.4)\r\n","Requirement already satisfied: tqdm in /opt/conda/lib/python3.10/site-packages (from mne->gcpds-visualizations==0.6) (4.66.4)\r\n","Collecting biopython>=1.78 (from python-circos->gcpds-visualizations==0.6)\r\n","  Downloading biopython-1.84-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\r\n","Requirement already satisfied: platformdirs>=2.5.0 in /opt/conda/lib/python3.10/site-packages (from pooch>=1.5->mne->gcpds-visualizations==0.6) (3.11.0)\r\n","Requirement already satisfied: requests>=2.19.0 in /opt/conda/lib/python3.10/site-packages (from pooch>=1.5->mne->gcpds-visualizations==0.6) (2.32.3)\r\n","Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib>=3.5.3->gcpds-visualizations==0.6) (1.16.0)\r\n","Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->mne->gcpds-visualizations==0.6) (2.1.3)\r\n","Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests>=2.19.0->pooch>=1.5->mne->gcpds-visualizations==0.6) (3.3.2)\r\n","Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests>=2.19.0->pooch>=1.5->mne->gcpds-visualizations==0.6) (3.6)\r\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests>=2.19.0->pooch>=1.5->mne->gcpds-visualizations==0.6) (1.26.18)\r\n","Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests>=2.19.0->pooch>=1.5->mne->gcpds-visualizations==0.6) (2024.2.2)\r\n","Downloading python_circos-0.3.0-py3-none-any.whl (27 kB)\r\n","Downloading biopython-1.84-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.2 MB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.2/3.2 MB\u001b[0m \u001b[31m33.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hBuilding wheels for collected packages: gcpds-visualizations\r\n","  Building wheel for gcpds-visualizations (setup.py) ... \u001b[?25l-\b \bdone\r\n","\u001b[?25h  Created wheel for gcpds-visualizations: filename=gcpds_visualizations-0.6-py3-none-any.whl size=12439 sha256=cfdfddbc7265249f41284a9320920a18e67af07889f4ae3c21387429fd40878d\r\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-l2c5m70s/wheels/fa/f8/e8/78c4b4940a8349e29d9199eee5e3c5f526123608864b3834af\r\n","Successfully built gcpds-visualizations\r\n","Installing collected packages: biopython, python-circos, gcpds-visualizations\r\n","Successfully installed biopython-1.84 gcpds-visualizations-0.6 python-circos-0.3.0\r\n"]}],"source":["!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.databases #Package for database reading.\n","!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models\n","!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.visualizations.git"]},{"cell_type":"code","execution_count":2,"id":"41926b03","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:08:55.048241Z","iopub.status.busy":"2024-10-23T16:08:55.04777Z","iopub.status.idle":"2024-10-23T16:09:14.983952Z","shell.execute_reply":"2024-10-23T16:09:14.982963Z"},"papermill":{"duration":19.959357,"end_time":"2024-10-23T16:09:14.986819","exception":false,"start_time":"2024-10-23T16:08:55.027462","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["2024-10-23 16:09:02.142132: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-10-23 16:09:02.142332: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-10-23 16:09:02.313378: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"]}],"source":["from gcpds.databases import GIGA_MI_ME\n","from typing import Optional, Sequence, Tuple\n","import numpy as np\n","from sklearn.base import BaseEstimator, TransformerMixin\n","from scipy.signal import freqz, filtfilt, resample\n","from scipy.signal import butter as bw\n","from tensorflow.keras.models import Model\n","from tensorflow.keras.layers import Dense, Activation, Dropout\n","from tensorflow.keras.layers import Conv2D, AveragePooling2D\n","from tensorflow.keras.layers import SeparableConv2D, DepthwiseConv2D\n","from tensorflow.keras.layers import BatchNormalization\n","from tensorflow.keras.layers import SpatialDropout2D\n","from sklearn.model_selection import train_test_split\n","from tensorflow.keras.layers import Input, Flatten\n","from tensorflow.keras.constraints import max_norm\n","import tensorflow as tf\n","from sklearn.preprocessing import OneHotEncoder\n","from sklearn.preprocessing import MinMaxScaler\n","from sklearn.decomposition import PCA\n","from sklearn.manifold import TSNE\n","import matplotlib.pyplot as plt\n","from gcpds.visualizations.connectivities import CircosConnectivity\n","from gcpds.visualizations.topoplots import topoplot\n","import pandas as pd\n","from sklearn.model_selection import KFold\n","from keras_tuner import HyperModel, RandomSearch, Objective\n","from IPython.display import FileLink"]},{"cell_type":"markdown","id":"d59f24e5","metadata":{"papermill":{"duration":0.017332,"end_time":"2024-10-23T16:09:15.021901","exception":false,"start_time":"2024-10-23T16:09:15.004569","status":"completed"},"tags":[]},"source":["# **Funciones usadas para el entrenamiento**"]},{"cell_type":"code","execution_count":3,"id":"d2eff4f7","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.059919Z","iopub.status.busy":"2024-10-23T16:09:15.059159Z","iopub.status.idle":"2024-10-23T16:09:15.07135Z","shell.execute_reply":"2024-10-23T16:09:15.070119Z"},"papermill":{"duration":0.033853,"end_time":"2024-10-23T16:09:15.0739","exception":false,"start_time":"2024-10-23T16:09:15.040047","status":"completed"},"tags":[]},"outputs":[],"source":["#from MI_EEG_ClassMeth.FeatExtraction import TimeFrequencyRpr\n","def load_GIGA(db: GIGA_MI_ME,\n","              sbj: int,\n","              eeg_ch_names: Sequence[str],\n","              fs: float, \n","              f_bank: np.ndarray, \n","              vwt: np.ndarray, \n","              new_fs: float) -> Tuple[np.ndarray, np.ndarray]:\n","    \"\"\"\n","    This function loads the GIGA-Science dataset locally.\n","    \n","    Parameters\n","    ----------\n","    db: GIGA_MI_ME\n","        A GIGA_MI_ME object created by the gcpds.databases.GIGA_MI_ME module\n","    sbj: int\n","        The subject to load\n","    eeg_ch_names: Sequence[str]\n","        The EEG channel names in order\n","    fs: float\n","        The sampling frecuency\n","    f_bank: np.ndarray\n","        The frecuency range(s) to use\n","    vwt: np.ndarray\n","        The time window to load\n","    new_fs: float\n","        The new sampling frecuency to resample the data to\n","    \n","    Returns\n","    ----------\n","    Tuple[np.ndarray, np.ndarray]\n","        A tuple containing the EEG signals for each trial and the corresponding label\n","    \n","    Notes\n","    ----------\n","    The database description can be found here:\n","    https://academic.oup.com/gigascience/article/6/7/gix034/3796323\n","    \"\"\"\n","    index_eeg_chs = db.format_channels_selectors(channels = eeg_ch_names) - 1\n","\n","    tf_repr = TimeFrequencyRpr(sfreq = fs, f_bank = f_bank, vwt = vwt)\n","\n","    db.load_subject(sbj)\n","    X, y = db.get_data(classes = ['left hand mi', 'right hand mi']) #Load MI classes, all channels {EEG}, reject bad trials, uV\n","    X = X[:, index_eeg_chs, :] #spatial rearrangement\n","    X = np.squeeze(tf_repr.transform(X))\n","    #Resampling\n","    if new_fs == fs:\n","        print('No resampling, since new sampling rate same.')\n","    else:\n","        print(\"Resampling from {:f} to {:f} Hz.\".format(fs, new_fs))\n","        X = resample(X, int((X.shape[-1]/fs)*new_fs), axis = -1)\n","\n","    #print(np.mean (X), np.var(X))\n","    return X, y"]},{"cell_type":"code","execution_count":4,"id":"acc6040c","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.112226Z","iopub.status.busy":"2024-10-23T16:09:15.111337Z","iopub.status.idle":"2024-10-23T16:09:15.120807Z","shell.execute_reply":"2024-10-23T16:09:15.119607Z"},"papermill":{"duration":0.0318,"end_time":"2024-10-23T16:09:15.123472","exception":false,"start_time":"2024-10-23T16:09:15.091672","status":"completed"},"tags":[]},"outputs":[],"source":["db = GIGA_MI_ME('/kaggle/input/giga-science-gcpds/GIGA_MI_ME')\n","fs = db.metadata['sampling_rate']\n","eeg_ch_names = ['Fp1','Fpz','Fp2',\n","              'AF7','AF3','AFz','AF4','AF8',\n","              'F7','F5','F3','F1','Fz','F2','F4','F6','F8',\n","              'FT7','FC5','FC3','FC1','FCz','FC2','FC4','FC6','FT8',\n","              'T7','C5','C3','C1','Cz','C2','C4','C6','T8',\n","              'TP7','CP5','CP3','CP1','CPz','CP2','CP4','CP6','TP8',\n","              'P9','P7','P5','P3','P1','Pz','P2','P4','P6','P8','P10',\n","              'PO7','PO3','POz','PO4','PO8',\n","              'O1','Oz','O2',\n","              'Iz']\n","load_args = dict(db = db,\n","                 eeg_ch_names = eeg_ch_names,\n","                 fs = fs,\n","                 f_bank = np.asarray([[4., 40.]]),\n","                 vwt = np.asarray([[2.5, 5]]),\n","                 new_fs = 128.)"]},{"cell_type":"code","execution_count":5,"id":"56d02765","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.161693Z","iopub.status.busy":"2024-10-23T16:09:15.160639Z","iopub.status.idle":"2024-10-23T16:09:15.188497Z","shell.execute_reply":"2024-10-23T16:09:15.187324Z"},"papermill":{"duration":0.049791,"end_time":"2024-10-23T16:09:15.191178","exception":false,"start_time":"2024-10-23T16:09:15.141387","status":"completed"},"tags":[]},"outputs":[],"source":["def butterworth_digital_filter(X, N, Wn, btype, fs, axis=-1, padtype=None, padlen=0, method='pad', irlen=None):\n","    \"\"\"\n","    Apply digital butterworth filter\n","    INPUT\n","    ------\n","    1. X: (D array)\n","    array with signals.\n","    2. N: (int+)\n","    The order of the filter.\n","    3. Wn: (float+ or 1D array)\n","    The critical frequency or frequencies. For lowpass and highpass filters, Wn is a scalar; for bandpass and bandstop filters, Wn is a length-2 vector.\n","    For a Butterworth filter, this is the point at which the gain drops to 1/sqrt(2) that of the passband (the “-3 dB point”).\n","    If fs is not specified, Wn units are normalized from 0 to 1, where 1 is the Nyquist frequency (Wn is thus in half cycles / sample and defined as 2*critical frequencies / fs). If fs is specified, Wn is in the same units as fs.\n","    4. btype: (str) {‘lowpass’, ‘highpass’, ‘bandpass’, ‘bandstop’}\n","    The type of filter\n","    5. fs: (float+)\n","    The sampling frequency of the digital system.\n","    6. axis: (int), Default=1.\n","    The axis of x to which the filter is applied.\n","    7. padtype: (str) or None, {'odd', 'even', 'constant'}\n","    This determines the type of extension to use for the padded signal to which the filter is applied. If padtype is None, no padding is used. The default is ‘odd’.\n","    8. padlen: (int+) or None, Default=0\n","    The number of elements by which to extend x at both ends of axis before applying the filter. This value must be less than x.shape[axis] - 1. padlen=0 implies no padding.\n","    9. method: (str), {'pad', 'gust'}\n","    Determines the method for handling the edges of the signal, either “pad” or “gust”. When method is “pad”, the signal is padded; the type of padding is determined by padtype\n","    and padlen, and irlen is ignored. When method is “gust”, Gustafsson’s method is used, and padtype and padlen are ignored.\n","    10. irlen: (int) or None, Default=nONE\n","    When method is “gust”, irlen specifies the length of the impulse response of the filter. If irlen is None, no part of the impulse response is ignored.\n","    For a long signal, specifying irlen can significantly improve the performance of the filter.\n","    OUTPUT\n","    ------\n","    X_fil: (D array)\n","    array with filtered signals.\n","    \"\"\"\n","    b, a = bw(N, Wn, btype, analog=False, output='ba', fs=fs)\n","    return filtfilt(b, a, X, axis=axis, padtype=padtype, padlen=padlen, method=method, irlen=irlen)\n","class TimeFrequencyRpr(BaseEstimator, TransformerMixin):\n","    \"\"\"\n","    Time frequency representation of EEG signals.\n","\n","    Parameters\n","    ----------\n","    1. sfreq:  (float) Sampling frequency in Hz.\n","    2. f_bank: (2D array) Filter banks Frequencies. Default=None\n","    3. vwt:    (2D array) Interest time windows. Default=None\n","    Methods\n","    -------\n","    1. fit(X, y=None)\n","    2. transform(X, y=None)\n","    \"\"\"\n","    def __init__(self, sfreq, f_bank=None, vwt=None):\n","        self.sfreq = sfreq\n","        self.f_bank = f_bank\n","        self.vwt = vwt\n","    # ------------------------------------------------------------------------------\n","\n","    def _validation_param(self):\n","        \"\"\"\n","        Validate Time-Frequency characterization parameters.\n","        INPUT\n","        -----\n","          1. self\n","        ------\n","          2. None\n","        \"\"\"\n","        if self.sfreq <= 0:\n","            raise ValueError('Non negative sampling frequency is accepted')\n","\n","\n","        if self.f_bank is None:\n","            self.flag_f_bank = False\n","        elif self.f_bank.ndim != 2:\n","            raise ValueError('Band frequencies have to be a 2D array')\n","        else:\n","            self.flag_f_bank = True\n","\n","        if self.vwt is None:\n","            self.flag_vwt = False\n","        elif self.vwt.ndim != 2:\n","            raise ValueError('Time windows have to be a 2D array')\n","        else:\n","            self.flag_vwt = True\n","\n","    # ------------------------------------------------------------------------------\n","    def _filter_bank(self, X):\n","        \"\"\"\n","        Filter bank Characterization.\n","        INPUT\n","        -----\n","          1. X: (3D array) set of EEG signals, shape (trials, channels, time_samples)\n","        OUTPUT\n","        ------\n","          1. X_f: (4D array) set of filtered EEG signals, shape (trials, channels, time_samples, frequency_bands)\n","        \"\"\"\n","        X_f = np.zeros((X.shape[0], X.shape[1], X.shape[2], self.f_bank.shape[0])) #epochs, Ch, Time, bands\n","        for f in np.arange(self.f_bank.shape[0]):\n","            X_f[:,:,:,f] = butterworth_digital_filter(X, N=5, Wn=self.f_bank[f], btype='bandpass', fs=self.sfreq)\n","        return X_f\n","\n","    # ------------------------------------------------------------------------------\n","    def _sliding_windows(self, X):\n","        \"\"\"\n","        Sliding Windows Characterization.\n","        INPUT\n","        -----\n","          1. X: (3D array) set of EEG signals, shape (trials, channels, time_samples)\n","        OUTPUT\n","        ------\n","          1. X_w: (4D array) shape (trials, channels, window_time_samples, number_of_windows)\n","        \"\"\"\n","        window_lenght = int(self.sfreq*self.vwt[0,1] - self.sfreq*self.vwt[0,0])\n","        X_w = np.zeros((X.shape[0], X.shape[1], window_lenght, self.vwt.shape[0]))\n","        for w in np.arange(self.vwt.shape[0]):\n","            X_w[:,:,:,w] = X[:,:,int(self.sfreq*self.vwt[w,0]):int(self.sfreq*self.vwt[w,1])]\n","        return X_w\n","\n","    # ------------------------------------------------------------------------------\n","    def fit(self, X, y=None):\n","        \"\"\"\n","        fit.\n","        INPUT\n","        -----\n","          1. X: (3D array) set of EEG signals, shape (trials, channels, time_samples)\n","          2. y: (1D array) target labels. Default=None\n","        OUTPUT\n","        ------\n","          1. None\n","        \"\"\"\n","        pass\n","\n","    # ------------------------------------------------------------------------------\n","    def transform(self, X, y=None):\n","        \"\"\"\n","        Time frequency representation of EEG signals.\n","        INPUT\n","        -----\n","          1. X: (3D array) set of EEG signals, shape (trials, channels, times)\n","        OUTPUT\n","        ------\n","          1. X_wf: (5D array) Time-frequency representation of EEG signals, shape (trials, channels, window_time_samples, number_of_windows, frequency_bands)\n","        \"\"\"\n","        self._validation_param()     #Validate sfreq, f_freq, vwt\n","\n","        #Avoid edge effects of digital filter, 1st:fbk, 2th:vwt\n","        if self.flag_f_bank:\n","            X_f = self._filter_bank(X)\n","        else:\n","            X_f = X[:,:,:,np.newaxis]\n","\n","        if self.flag_vwt:\n","            X_wf = []\n","            for f in range(X_f.shape[3]):\n","                X_wf.append(self._sliding_windows(X_f[:,:,:,f]))\n","            X_wf = np.stack(X_wf, axis=-1)\n","        else:\n","            X_wf = X_f[:,:,:,np.newaxis,:]\n","        return X_wf"]},{"cell_type":"code","execution_count":6,"id":"602b2079","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.229243Z","iopub.status.busy":"2024-10-23T16:09:15.22882Z","iopub.status.idle":"2024-10-23T16:09:15.247194Z","shell.execute_reply":"2024-10-23T16:09:15.246121Z"},"papermill":{"duration":0.040884,"end_time":"2024-10-23T16:09:15.249925","exception":false,"start_time":"2024-10-23T16:09:15.209041","status":"completed"},"tags":[]},"outputs":[],"source":["def EEGNet(nb_classes, Chans = 64, Samples = 128, \n","             dropoutRate = 0.5, kernLength = 64, F1 = 8, \n","             D = 2, F2 = 16, norm_rate = 0.25, dropoutType = 'Dropout'):\n","    \"\"\" Keras Implementation of EEGNet\n","    http://iopscience.iop.org/article/10.1088/1741-2552/aace8c/meta\n","    Note that this implements the newest version of EEGNet and NOT the earlier\n","    version (version v1 and v2 on arxiv). We strongly recommend using this\n","    architecture as it performs much better and has nicer properties than\n","    our earlier version. For example:\n","        \n","        1. Depthwise Convolutions to learn spatial filters within a \n","        temporal convolution. The use of the depth_multiplier option maps \n","        exactly to the number of spatial filters learned within a temporal\n","        filter. This matches the setup of algorithms like FBCSP which learn \n","        spatial filters within each filter in a filter-bank. This also limits \n","        the number of free parameters to fit when compared to a fully-connected\n","        convolution. \n","        \n","        2. Separable Convolutions to learn how to optimally combine spatial\n","        filters across temporal bands. Separable Convolutions are Depthwise\n","        Convolutions followed by (1x1) Pointwise Convolutions. \n","        \n","    \n","    While the original paper used Dropout, we found that SpatialDropout2D \n","    sometimes produced slightly better results for classification of ERP \n","    signals. However, SpatialDropout2D significantly reduced performance \n","    on the Oscillatory dataset (SMR, BCI-IV Dataset 2A). We recommend using\n","    the default Dropout in most cases.\n","        \n","    Assumes the input signal is sampled at 128Hz. If you want to use this model\n","    for any other sampling rate you will need to modify the lengths of temporal\n","    kernels and average pooling size in blocks 1 and 2 as needed (double the \n","    kernel lengths for double the sampling rate, etc). Note that we haven't \n","    tested the model performance with this rule so this may not work well. \n","    \n","    The model with default parameters gives the EEGNet-8,2 model as discussed\n","    in the paper. This model should do pretty well in general, although it is\n","\tadvised to do some model searching to get optimal performance on your\n","\tparticular dataset.\n","    We set F2 = F1 * D (number of input filters = number of output filters) for\n","    the SeparableConv2D layer. We haven't extensively tested other values of this\n","    parameter (say, F2 < F1 * D for compressed learning, and F2 > F1 * D for\n","    overcomplete). We believe the main parameters to focus on are F1 and D. \n","    Inputs:\n","        \n","      nb_classes      : int, number of classes to classify\n","      Chans, Samples  : number of channels and time points in the EEG data\n","      dropoutRate     : dropout fraction\n","      kernLength      : length of temporal convolution in first layer. We found\n","                        that setting this to be half the sampling rate worked\n","                        well in practice. For the SMR dataset in particular\n","                        since the data was high-passed at 4Hz we used a kernel\n","                        length of 32.     \n","      F1, F2          : number of temporal filters (F1) and number of pointwise\n","                        filters (F2) to learn. Default: F1 = 8, F2 = F1 * D. \n","      D               : number of spatial filters to learn within each temporal\n","                        convolution. Default: D = 2\n","      dropoutType     : Either SpatialDropout2D or Dropout, passed as a string.\n","    \"\"\"\n","    \n","    if dropoutType == 'SpatialDropout2D':\n","        dropoutType = SpatialDropout2D\n","    elif dropoutType == 'Dropout':\n","        dropoutType = Dropout\n","    else:\n","        raise ValueError('dropoutType must be one of SpatialDropout2D '\n","                         'or Dropout, passed as a string.')\n","    \n","    input1   = Input(shape = (Chans, Samples, 1))\n","\n","    ##################################################################\n","    block1       = Conv2D(F1, (1, kernLength), padding = 'same',\n","                                   name='Conv2D_1',\n","                                   input_shape = (Chans, Samples, 1),\n","                                   use_bias = False)(input1)\n","    block1       = BatchNormalization()(block1)\n","    block1       = DepthwiseConv2D((Chans, 1), use_bias = False, \n","                                   name='Depth_wise_Conv2D_1',\n","                                   depth_multiplier = D,\n","                                   depthwise_constraint = max_norm(1.))(block1)\n","    block1       = BatchNormalization()(block1)\n","    block1       = Activation('elu')(block1)\n","    block1       = AveragePooling2D((1, 4))(block1)\n","    block1       = dropoutType(dropoutRate)(block1)\n","    \n","    block2       = SeparableConv2D(F2, (1, 16),\n","                                   name='Separable_Conv2D_1',\n","                                   use_bias = False, padding = 'same')(block1) # factorización para que sea más eficiente\n","    block2       = BatchNormalization()(block2)\n","    block2       = Activation('elu')(block2)\n","    block2       = AveragePooling2D((1, 8))(block2)\n","    block2       = dropoutType(dropoutRate)(block2)\n","        \n","    flatten      = Flatten(name = 'flatten')(block2)\n","    \n","    dense        = Dense(nb_classes, name = 'output', \n","                         kernel_constraint = max_norm(norm_rate))(flatten)\n","    softmax      = Activation('softmax', name = 'out_activation')(dense)\n","    \n","    return Model(inputs=input1, outputs=softmax)"]},{"cell_type":"code","execution_count":7,"id":"3a4d0591","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.287799Z","iopub.status.busy":"2024-10-23T16:09:15.287037Z","iopub.status.idle":"2024-10-23T16:09:15.301711Z","shell.execute_reply":"2024-10-23T16:09:15.300534Z"},"papermill":{"duration":0.036659,"end_time":"2024-10-23T16:09:15.304326","exception":false,"start_time":"2024-10-23T16:09:15.267667","status":"completed"},"tags":[]},"outputs":[],"source":["def CV_giga(sbj, results_df):\n","    \"\"\"\n","    Realiza la validación cruzada en los datos de EEG de un sujeto específico utilizando el modelo EEGNet.\n","\n","    La función entrena un modelo EEGNet para clasificar señales EEG en una tarea de clasificación binaria.\n","    Se utiliza validación cruzada con 5 pliegues (folds) para evaluar la precisión del modelo. Los resultados\n","    de cada pliegue se agregan para calcular la precisión promedio y la desviación estándar. Finalmente, los\n","    resultados se guardan en un DataFrame.\n","\n","    Parámetros:\n","    -----------\n","    sbj : int\n","        Identificador del sujeto del que se van a cargar los datos de EEG.\n","    results_df : pandas.DataFrame\n","        DataFrame en el que se guardan los resultados de la validación cruzada, incluyendo la precisión media\n","        y la desviación estándar para cada sujeto.\n","\n","    Retorna:\n","    --------\n","    results_df : pandas.DataFrame\n","        DataFrame actualizado con los resultados de la validación cruzada para el sujeto actual.\n","\n","    Descripción del proceso:\n","    ------------------------\n","    1. Carga de datos:\n","       - Se cargan los datos de EEG para el sujeto especificado mediante la función `load_GIGA`.\n","       - Las etiquetas (`y`) se transforman a un formato de codificación one-hot.\n","\n","    2. Configuración de la validación cruzada:\n","       - Se utiliza `KFold` para realizar validación cruzada con 5 pliegues, donde los datos se dividen aleatoriamente en\n","         5 subconjuntos para entrenamiento y prueba.\n","\n","    3. Entrenamiento y evaluación del modelo:\n","       - En cada pliegue, se entrena un modelo EEGNet con los datos de entrenamiento y se evalúa con los datos de prueba.\n","       - Las precisiones de cada pliegue se almacenan en la lista `accuracies`.\n","\n","    4. Cálculo de resultados:\n","       - Se calcula la precisión media y la desviación estándar a partir de los resultados obtenidos en los pliegues.\n","\n","    5. Almacenamiento de resultados:\n","       - Se almacenan la precisión media y la desviación estándar para el sujeto actual en el DataFrame `results_df`.\n","    \n","    Ejemplo de uso:\n","    ---------------\n","    # Crear un DataFrame vacío para almacenar resultados\n","    results_df = pd.DataFrame(columns=['Subject', 'Mean Accuracy', 'Standard Deviation'])\n","\n","    # Llamar a la función para un sujeto específico\n","    results_df = CV_giga(sbj=1, results_df=results_df)\n","    \"\"\"\n","    \n","    print(\"Training subject\", sbj)\n","    X, y = load_GIGA(sbj=sbj, **load_args)\n","\n","    encoder = OneHotEncoder(sparse_output=True)\n","    y = encoder.fit_transform(y.reshape(-1,1)).toarray()\n","\n","    kfold = KFold(n_splits=5, shuffle=True, random_state=42)\n","    accuracies = []\n","\n","    for train, test in kfold.split(X, y):\n","        # Crear el modelo\n","        model = EEGNet(2, Samples=320, norm_rate=0.1, kernLength=64)\n","        model.compile(optimizer='Adam', loss='binary_crossentropy', metrics=['categorical_accuracy'])\n","\n","        # Entrenar el modelo\n","        history = model.fit(X[train], y[train], epochs=150, batch_size=32, verbose=0,\n","                            validation_data=(X[test], y[test]))\n","\n","        # Evaluar el modelo en el fold actual\n","        scores = model.evaluate(X[test], y[test], verbose=1)\n","        accuracies.append(scores[-1])\n","\n","    # Calcular la media y desviación estándar\n","    mean_accuracy = np.mean(accuracies)\n","    std_accuracy = np.std(accuracies)\n","\n","    # Mostrar resultados de la validación cruzada\n","    print(f\"Mean Val Binary Accuracy: {mean_accuracy * 100:.2f}% (+/- {std_accuracy * 100:.2f}%)\")\n","\n","    # Guardar los resultados en el DataFrame\n","    results_df = results_df.append({\n","        'Subject': sbj,\n","        'Mean Accuracy': mean_accuracy,\n","        'Standard Deviation': std_accuracy\n","    }, ignore_index=True)\n","\n","    return results_df"]},{"cell_type":"markdown","id":"21602294","metadata":{"papermill":{"duration":0.017329,"end_time":"2024-10-23T16:09:15.339389","exception":false,"start_time":"2024-10-23T16:09:15.32206","status":"completed"},"tags":[]},"source":["## **Cross-validation**"]},{"cell_type":"code","execution_count":8,"id":"911ce02c","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.376292Z","iopub.status.busy":"2024-10-23T16:09:15.375862Z","iopub.status.idle":"2024-10-23T16:09:15.387188Z","shell.execute_reply":"2024-10-23T16:09:15.386107Z"},"papermill":{"duration":0.032743,"end_time":"2024-10-23T16:09:15.389804","exception":false,"start_time":"2024-10-23T16:09:15.357061","status":"completed"},"tags":[]},"outputs":[],"source":["# Crear un DataFrame vacío\n","results_df = pd.DataFrame(columns=['Subject', 'Mean Accuracy', 'Standard Deviation'])"]},{"cell_type":"code","execution_count":9,"id":"83d46c52","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:09:15.427549Z","iopub.status.busy":"2024-10-23T16:09:15.427079Z","iopub.status.idle":"2024-10-23T16:48:50.927918Z","shell.execute_reply":"2024-10-23T16:48:50.926736Z"},"papermill":{"duration":2375.567343,"end_time":"2024-10-23T16:48:50.97509","exception":false,"start_time":"2024-10-23T16:09:15.407747","status":"completed"},"scrolled":true,"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Training subject 1\n","Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:09:25.305921: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel/dropout/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n","WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n","I0000 00:00:1729699768.866061     212 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.5183 - categorical_accuracy: 0.8250\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5463 - categorical_accuracy: 0.7750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4892 - categorical_accuracy: 0.7750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4466 - categorical_accuracy: 0.8500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:10:28.745290: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_4/dropout_8/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.4903 - categorical_accuracy: 0.8000\n","Mean Val Binary Accuracy: 80.50% (+/- 2.92%)\n","Training subject 2\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7225 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.8066 - categorical_accuracy: 0.3750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7374 - categorical_accuracy: 0.5000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:11:32.925722: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_8/dropout_16/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.7341 - categorical_accuracy: 0.5750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7872 - categorical_accuracy: 0.4750\n","Mean Val Binary Accuracy: 49.00% (+/- 6.63%)\n","Training subject 3\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 9ms/step - loss: 0.2901 - categorical_accuracy: 0.9500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2710 - categorical_accuracy: 0.9750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:12:37.047789: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_12/dropout_24/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.3559 - categorical_accuracy: 0.8750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2710 - categorical_accuracy: 0.9750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.2804 - categorical_accuracy: 1.0000\n","Mean Val Binary Accuracy: 95.50% (+/- 4.30%)\n","Training subject 4\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3335 - categorical_accuracy: 0.9250\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:13:41.668159: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_16/dropout_32/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.3710 - categorical_accuracy: 0.8750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4129 - categorical_accuracy: 0.9000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4559 - categorical_accuracy: 0.8000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3689 - categorical_accuracy: 0.9500\n","Mean Val Binary Accuracy: 89.00% (+/- 5.15%)\n","Training subject 5\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:14:47.531823: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_20/dropout_40/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4938 - categorical_accuracy: 0.7250\n","2/2 [==============================] - 0s 11ms/step - loss: 0.6201 - categorical_accuracy: 0.7000\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5009 - categorical_accuracy: 0.8500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5866 - categorical_accuracy: 0.6000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:15:53.612485: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_24/dropout_48/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5226 - categorical_accuracy: 0.6667\n","Mean Val Binary Accuracy: 70.83% (+/- 8.23%)\n","Training subject 6\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5516 - categorical_accuracy: 0.7500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5492 - categorical_accuracy: 0.6667\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4587 - categorical_accuracy: 0.7778\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:17:04.185872: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_28/dropout_56/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4462 - categorical_accuracy: 0.8000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4991 - categorical_accuracy: 0.7714\n","Mean Val Binary Accuracy: 75.32% (+/- 4.61%)\n","Training subject 7\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7814 - categorical_accuracy: 0.4583\n","2/2 [==============================] - 0s 10ms/step - loss: 0.7249 - categorical_accuracy: 0.5208\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:18:16.963267: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_32/dropout_64/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7667 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7597 - categorical_accuracy: 0.4167\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7471 - categorical_accuracy: 0.5833\n","Mean Val Binary Accuracy: 49.58% (+/- 5.65%)\n","Training subject 8\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7839 - categorical_accuracy: 0.5000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:19:27.758371: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_36/dropout_72/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.8140 - categorical_accuracy: 0.3500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7259 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7918 - categorical_accuracy: 0.4103\n","2/2 [==============================] - 0s 7ms/step - loss: 0.6761 - categorical_accuracy: 0.5897\n","Mean Val Binary Accuracy: 47.50% (+/- 8.50%)\n","Training subject 9\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:20:40.181657: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_40/dropout_80/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.6162 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6937 - categorical_accuracy: 0.5208\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7333 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5998 - categorical_accuracy: 0.6875\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:21:49.959159: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_44/dropout_88/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.7097 - categorical_accuracy: 0.5833\n","Mean Val Binary Accuracy: 58.33% (+/- 6.85%)\n","Training subject 10\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4750 - categorical_accuracy: 0.8000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5758 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5183 - categorical_accuracy: 0.7750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:22:59.816173: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_48/dropout_96/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4831 - categorical_accuracy: 0.8250\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5546 - categorical_accuracy: 0.7250\n","Mean Val Binary Accuracy: 75.00% (+/- 7.07%)\n","Training subject 11\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6984 - categorical_accuracy: 0.6750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.8009 - categorical_accuracy: 0.4500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:24:05.831635: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_52/dropout_104/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.7831 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7561 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6288 - categorical_accuracy: 0.6250\n","Mean Val Binary Accuracy: 56.00% (+/- 8.00%)\n","Training subject 12\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7073 - categorical_accuracy: 0.6286\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:25:11.635164: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_56/dropout_112/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.5936 - categorical_accuracy: 0.6857\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5856 - categorical_accuracy: 0.6857\n","2/2 [==============================] - 0s 14ms/step - loss: 0.5648 - categorical_accuracy: 0.6571\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5383 - categorical_accuracy: 0.7353\n","Mean Val Binary Accuracy: 67.85% (+/- 3.54%)\n","Training subject 13\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:26:23.710607: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_60/dropout_120/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4445 - categorical_accuracy: 0.9000\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4902 - categorical_accuracy: 0.7750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5018 - categorical_accuracy: 0.8250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4335 - categorical_accuracy: 0.9500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:27:24.051588: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_64/dropout_128/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4588 - categorical_accuracy: 0.9000\n","Mean Val Binary Accuracy: 87.00% (+/- 6.20%)\n","Training subject 14\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.2431 - categorical_accuracy: 0.9750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2540 - categorical_accuracy: 0.9750\n","2/2 [==============================] - 0s 10ms/step - loss: 0.2869 - categorical_accuracy: 0.9750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:28:30.939786: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_68/dropout_136/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.2386 - categorical_accuracy: 1.0000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2867 - categorical_accuracy: 0.9500\n","Mean Val Binary Accuracy: 97.50% (+/- 1.58%)\n","Training subject 15\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 9ms/step - loss: 0.7214 - categorical_accuracy: 0.4615\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7397 - categorical_accuracy: 0.4474\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:29:41.616670: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_72/dropout_144/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5796 - categorical_accuracy: 0.6842\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7028 - categorical_accuracy: 0.5789\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5645 - categorical_accuracy: 0.6316\n","Mean Val Binary Accuracy: 56.07% (+/- 9.30%)\n","Training subject 16\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7830 - categorical_accuracy: 0.4250\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:30:53.602460: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_76/dropout_152/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.6169 - categorical_accuracy: 0.7000\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7062 - categorical_accuracy: 0.5500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.8583 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 11ms/step - loss: 0.6763 - categorical_accuracy: 0.6667\n","Mean Val Binary Accuracy: 59.33% (+/- 9.80%)\n","Training subject 17\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:32:07.089514: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_80/dropout_160/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.8000 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6826 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.6919 - categorical_accuracy: 0.5500\n","2/2 [==============================] - 0s 10ms/step - loss: 0.6047 - categorical_accuracy: 0.7000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:33:10.414287: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_84/dropout_168/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7202 - categorical_accuracy: 0.4750\n","Mean Val Binary Accuracy: 55.00% (+/- 7.91%)\n","Training subject 18\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6311 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5559 - categorical_accuracy: 0.7750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4814 - categorical_accuracy: 0.8000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:34:17.052309: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_88/dropout_176/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.5760 - categorical_accuracy: 0.6750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7070 - categorical_accuracy: 0.5750\n","Mean Val Binary Accuracy: 69.00% (+/- 8.60%)\n","Training subject 19\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","1/1 [==============================] - 0s 31ms/step - loss: 0.6813 - categorical_accuracy: 0.5862\n","1/1 [==============================] - 0s 31ms/step - loss: 0.8363 - categorical_accuracy: 0.3448\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:35:20.958894: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_92/dropout_184/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 0s 31ms/step - loss: 0.5850 - categorical_accuracy: 0.6897\n","1/1 [==============================] - 0s 32ms/step - loss: 0.7639 - categorical_accuracy: 0.4286\n","1/1 [==============================] - 0s 31ms/step - loss: 0.6103 - categorical_accuracy: 0.6786\n","Mean Val Binary Accuracy: 54.56% (+/- 13.72%)\n","Training subject 20\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","1/1 [==============================] - 0s 33ms/step - loss: 0.6763 - categorical_accuracy: 0.5882\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:36:23.276452: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_96/dropout_192/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 0s 31ms/step - loss: 0.5214 - categorical_accuracy: 0.8235\n","1/1 [==============================] - 0s 32ms/step - loss: 0.6002 - categorical_accuracy: 0.7647\n","1/1 [==============================] - 0s 32ms/step - loss: 0.5810 - categorical_accuracy: 0.6875\n","1/1 [==============================] - 0s 31ms/step - loss: 0.6147 - categorical_accuracy: 0.6250\n","Mean Val Binary Accuracy: 69.78% (+/- 8.68%)\n","Training subject 21\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:37:24.229867: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_100/dropout_200/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.4299 - categorical_accuracy: 0.9000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6372 - categorical_accuracy: 0.6000\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6219 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5658 - categorical_accuracy: 0.7500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:38:33.118124: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_104/dropout_208/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.4739 - categorical_accuracy: 0.7949\n","Mean Val Binary Accuracy: 73.40% (+/- 11.08%)\n","Training subject 22\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5425 - categorical_accuracy: 0.8000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6329 - categorical_accuracy: 0.5750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7284 - categorical_accuracy: 0.5750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:39:38.519803: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_108/dropout_216/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.5592 - categorical_accuracy: 0.7250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5678 - categorical_accuracy: 0.8000\n","Mean Val Binary Accuracy: 69.50% (+/- 10.17%)\n","Training subject 23\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 15ms/step - loss: 0.3165 - categorical_accuracy: 1.0000\n","2/2 [==============================] - 0s 10ms/step - loss: 0.3517 - categorical_accuracy: 0.9000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:40:47.381673: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_112/dropout_224/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.3669 - categorical_accuracy: 0.9744\n","2/2 [==============================] - 0s 18ms/step - loss: 0.3865 - categorical_accuracy: 0.8974\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3692 - categorical_accuracy: 0.8974\n","Mean Val Binary Accuracy: 93.38% (+/- 4.43%)\n","Training subject 24\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6714 - categorical_accuracy: 0.6000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:41:58.983546: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_116/dropout_232/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.7141 - categorical_accuracy: 0.6000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6277 - categorical_accuracy: 0.7000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7576 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5927 - categorical_accuracy: 0.7179\n","Mean Val Binary Accuracy: 62.86% (+/- 7.13%)\n","Training subject 25\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:43:10.381822: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_120/dropout_240/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.5842 - categorical_accuracy: 0.7500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5807 - categorical_accuracy: 0.6154\n","2/2 [==============================] - 0s 10ms/step - loss: 0.4513 - categorical_accuracy: 0.8462\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4898 - categorical_accuracy: 0.8205\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:44:14.669636: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_124/dropout_248/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.6408 - categorical_accuracy: 0.7179\n","Mean Val Binary Accuracy: 75.00% (+/- 8.17%)\n","Training subject 26\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6137 - categorical_accuracy: 0.7000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5330 - categorical_accuracy: 0.7250\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5741 - categorical_accuracy: 0.7500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:45:24.654583: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_128/dropout_256/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 10ms/step - loss: 0.5388 - categorical_accuracy: 0.7500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5410 - categorical_accuracy: 0.7500\n","Mean Val Binary Accuracy: 73.50% (+/- 2.00%)\n","Training subject 27\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7221 - categorical_accuracy: 0.5946\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7080 - categorical_accuracy: 0.5135\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:46:36.051595: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_132/dropout_264/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7055 - categorical_accuracy: 0.5135\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7071 - categorical_accuracy: 0.5676\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7856 - categorical_accuracy: 0.5676\n","Mean Val Binary Accuracy: 55.14% (+/- 3.24%)\n","Training subject 28\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5823 - categorical_accuracy: 0.7000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:47:46.976987: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_136/dropout_272/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5092 - categorical_accuracy: 0.8718\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5971 - categorical_accuracy: 0.6667\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7272 - categorical_accuracy: 0.6410\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5643 - categorical_accuracy: 0.7179\n","Mean Val Binary Accuracy: 71.95% (+/- 8.07%)\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]}],"source":["# Iterar sobre los sujetos y guardar los resultados\n","for sbj in range(1, 29):\n","    results_df = CV_giga(sbj, results_df)"]},{"cell_type":"code","execution_count":10,"id":"fdb8b93a","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:48:51.083447Z","iopub.status.busy":"2024-10-23T16:48:51.083038Z","iopub.status.idle":"2024-10-23T16:54:26.495594Z","shell.execute_reply":"2024-10-23T16:54:26.494419Z"},"papermill":{"duration":335.469656,"end_time":"2024-10-23T16:54:26.497972","exception":false,"start_time":"2024-10-23T16:48:51.028316","status":"completed"},"scrolled":true,"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Training subject 30\n","Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:48:58.212937: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_140/dropout_280/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 0s 32ms/step - loss: 0.7610 - categorical_accuracy: 0.4800\n","1/1 [==============================] - 0s 31ms/step - loss: 0.7074 - categorical_accuracy: 0.5600\n","1/1 [==============================] - 0s 30ms/step - loss: 0.6589 - categorical_accuracy: 0.5833\n","1/1 [==============================] - 0s 30ms/step - loss: 0.6910 - categorical_accuracy: 0.5833\n","1/1 [==============================] - 0s 31ms/step - loss: 0.7191 - categorical_accuracy: 0.5417\n","Mean Val Binary Accuracy: 54.97% (+/- 3.82%)\n","Training subject 31\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:50:18.057011: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_145/dropout_290/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5794 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5800 - categorical_accuracy: 0.7250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7693 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6062 - categorical_accuracy: 0.7000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:51:22.066716: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_149/dropout_298/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7302 - categorical_accuracy: 0.5128\n","Mean Val Binary Accuracy: 61.26% (+/- 9.28%)\n","Training subject 32\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.8223 - categorical_accuracy: 0.4500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7164 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7651 - categorical_accuracy: 0.5000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:52:29.720900: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_153/dropout_306/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7757 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7361 - categorical_accuracy: 0.5000\n","Mean Val Binary Accuracy: 49.00% (+/- 2.00%)\n","Training subject 33\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6881 - categorical_accuracy: 0.6000\n","2/2 [==============================] - 0s 9ms/step - loss: 0.7112 - categorical_accuracy: 0.5500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:53:38.324599: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_157/dropout_314/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7376 - categorical_accuracy: 0.5750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7324 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7534 - categorical_accuracy: 0.4359\n","Mean Val Binary Accuracy: 53.22% (+/- 5.84%)\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]}],"source":["# Iterar sobre los sujetos y guardar los resultados\n","for sbj in range(30, 34):\n","    results_df = CV_giga(sbj, results_df)"]},{"cell_type":"code","execution_count":11,"id":"89abbf39","metadata":{"execution":{"iopub.execute_input":"2024-10-23T16:54:26.614774Z","iopub.status.busy":"2024-10-23T16:54:26.614055Z","iopub.status.idle":"2024-10-23T17:20:17.111303Z","shell.execute_reply":"2024-10-23T17:20:17.110211Z"},"papermill":{"duration":1550.636094,"end_time":"2024-10-23T17:20:17.191515","exception":false,"start_time":"2024-10-23T16:54:26.555421","status":"completed"},"scrolled":true,"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Training subject 35\n","Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3331 - categorical_accuracy: 0.9500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:54:50.064113: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_161/dropout_322/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 10ms/step - loss: 0.5109 - categorical_accuracy: 0.7500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4613 - categorical_accuracy: 0.7750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4108 - categorical_accuracy: 0.8250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4059 - categorical_accuracy: 0.9000\n","Mean Val Binary Accuracy: 84.00% (+/- 7.52%)\n","Training subject 36\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:56:03.858949: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_165/dropout_330/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.6030 - categorical_accuracy: 0.7179\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6078 - categorical_accuracy: 0.7436\n","2/2 [==============================] - 0s 8ms/step - loss: 0.9018 - categorical_accuracy: 0.5128\n","2/2 [==============================] - 0s 11ms/step - loss: 0.5916 - categorical_accuracy: 0.6410\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:57:10.753907: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_169/dropout_338/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4968 - categorical_accuracy: 0.8462\n","Mean Val Binary Accuracy: 69.23% (+/- 11.12%)\n","Training subject 37\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5852 - categorical_accuracy: 0.6500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5108 - categorical_accuracy: 0.7250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4191 - categorical_accuracy: 0.8750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:58:17.292493: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_173/dropout_346/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5709 - categorical_accuracy: 0.7250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5142 - categorical_accuracy: 0.7750\n","Mean Val Binary Accuracy: 75.00% (+/- 7.42%)\n","Training subject 38\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7029 - categorical_accuracy: 0.4615\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6686 - categorical_accuracy: 0.6053\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 16:59:26.247616: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_177/dropout_354/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7159 - categorical_accuracy: 0.5000\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6842 - categorical_accuracy: 0.5263\n","2/2 [==============================] - 0s 8ms/step - loss: 0.8449 - categorical_accuracy: 0.5263\n","Mean Val Binary Accuracy: 52.39% (+/- 4.71%)\n","Training subject 39\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5990 - categorical_accuracy: 0.7250\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:00:40.795052: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_181/dropout_362/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5708 - categorical_accuracy: 0.6750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6274 - categorical_accuracy: 0.6500\n","2/2 [==============================] - 0s 13ms/step - loss: 0.6925 - categorical_accuracy: 0.4500\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6050 - categorical_accuracy: 0.6410\n","Mean Val Binary Accuracy: 62.82% (+/- 9.38%)\n","Training subject 40\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:01:52.591878: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_185/dropout_370/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.6864 - categorical_accuracy: 0.6250\n","2/2 [==============================] - 0s 9ms/step - loss: 0.7129 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6884 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7949 - categorical_accuracy: 0.6000\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7778 - categorical_accuracy: 0.5000\n","Mean Val Binary Accuracy: 55.50% (+/- 4.85%)\n","Training subject 41\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:03:13.329521: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_190/dropout_380/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 7ms/step - loss: 0.3032 - categorical_accuracy: 0.9500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3986 - categorical_accuracy: 0.8750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.3365 - categorical_accuracy: 0.9000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4593 - categorical_accuracy: 0.8750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:04:21.314731: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_194/dropout_388/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.3580 - categorical_accuracy: 0.9231\n","Mean Val Binary Accuracy: 90.46% (+/- 2.89%)\n","Training subject 42\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 9ms/step - loss: 0.6591 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.6375 - categorical_accuracy: 0.7000\n","2/2 [==============================] - 0s 7ms/step - loss: 0.6992 - categorical_accuracy: 0.5750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:05:27.316704: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_198/dropout_396/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.5672 - categorical_accuracy: 0.7500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7070 - categorical_accuracy: 0.6500\n","Mean Val Binary Accuracy: 64.00% (+/- 8.15%)\n","Training subject 43\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2049 - categorical_accuracy: 0.9750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2553 - categorical_accuracy: 1.0000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:06:33.824449: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_202/dropout_404/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.2563 - categorical_accuracy: 1.0000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2703 - categorical_accuracy: 0.9750\n","2/2 [==============================] - 0s 7ms/step - loss: 0.2298 - categorical_accuracy: 1.0000\n","Mean Val Binary Accuracy: 99.00% (+/- 1.22%)\n","Training subject 44\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4792 - categorical_accuracy: 0.7750\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:07:40.382943: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_206/dropout_412/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 6ms/step - loss: 0.4092 - categorical_accuracy: 0.8500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.4573 - categorical_accuracy: 0.8500\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5273 - categorical_accuracy: 0.7000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4883 - categorical_accuracy: 0.7750\n","Mean Val Binary Accuracy: 79.00% (+/- 5.61%)\n","Training subject 45\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:08:46.813893: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_210/dropout_420/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7048 - categorical_accuracy: 0.5250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6748 - categorical_accuracy: 0.5750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7900 - categorical_accuracy: 0.4500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7578 - categorical_accuracy: 0.5750\n","2/2 [==============================] - 0s 9ms/step - loss: 0.8045 - categorical_accuracy: 0.5500\n","Mean Val Binary Accuracy: 53.50% (+/- 4.64%)\n","Training subject 46\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:10:09.517702: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_215/dropout_430/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 10ms/step - loss: 0.5158 - categorical_accuracy: 0.7917\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5846 - categorical_accuracy: 0.6875\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6038 - categorical_accuracy: 0.6875\n","2/2 [==============================] - 0s 8ms/step - loss: 0.4964 - categorical_accuracy: 0.7083\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:11:20.282221: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_219/dropout_438/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.5370 - categorical_accuracy: 0.7234\n","Mean Val Binary Accuracy: 71.97% (+/- 3.85%)\n","Training subject 47\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5202 - categorical_accuracy: 0.7436\n","2/2 [==============================] - 0s 8ms/step - loss: 0.5090 - categorical_accuracy: 0.7179\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5241 - categorical_accuracy: 0.8158\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:12:34.242929: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_223/dropout_446/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4423 - categorical_accuracy: 0.8158\n","2/2 [==============================] - 0s 11ms/step - loss: 0.5541 - categorical_accuracy: 0.7368\n","Mean Val Binary Accuracy: 76.60% (+/- 4.15%)\n","Training subject 48\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3380 - categorical_accuracy: 0.9500\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3836 - categorical_accuracy: 0.9250\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:13:44.932338: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_227/dropout_454/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.3786 - categorical_accuracy: 0.9250\n","2/2 [==============================] - 0s 7ms/step - loss: 0.3346 - categorical_accuracy: 0.9750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.2836 - categorical_accuracy: 0.9744\n","Mean Val Binary Accuracy: 94.99% (+/- 2.22%)\n","Training subject 49\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 10ms/step - loss: 0.5261 - categorical_accuracy: 0.7179\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:14:55.218995: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_231/dropout_462/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4749 - categorical_accuracy: 0.8205\n","2/2 [==============================] - 0s 9ms/step - loss: 0.5386 - categorical_accuracy: 0.7105\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5356 - categorical_accuracy: 0.7368\n","2/2 [==============================] - 0s 9ms/step - loss: 0.4878 - categorical_accuracy: 0.8158\n","Mean Val Binary Accuracy: 76.03% (+/- 4.80%)\n","Training subject 50\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:16:11.561009: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_235/dropout_470/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 9ms/step - loss: 0.3816 - categorical_accuracy: 0.9000\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3712 - categorical_accuracy: 0.9250\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3848 - categorical_accuracy: 0.8750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.3837 - categorical_accuracy: 0.9000\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:17:13.828206: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_239/dropout_478/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.4347 - categorical_accuracy: 0.8000\n","Mean Val Binary Accuracy: 88.00% (+/- 4.30%)\n","Training subject 51\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 12ms/step - loss: 0.7733 - categorical_accuracy: 0.4615\n","2/2 [==============================] - 0s 8ms/step - loss: 0.7268 - categorical_accuracy: 0.5128\n","2/2 [==============================] - 0s 10ms/step - loss: 0.6981 - categorical_accuracy: 0.5128\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:18:24.887382: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_243/dropout_486/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.6690 - categorical_accuracy: 0.5641\n","2/2 [==============================] - 0s 9ms/step - loss: 0.7773 - categorical_accuracy: 0.3684\n","Mean Val Binary Accuracy: 48.39% (+/- 6.62%)\n","Training subject 52\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]},{"name":"stdout","output_type":"stream","text":["Resampling from 512.000000 to 128.000000 Hz.\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7363 - categorical_accuracy: 0.5500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.7229 - categorical_accuracy: 0.5500\n"]},{"name":"stderr","output_type":"stream","text":["2024-10-23 17:19:33.847900: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape inmodel_247/dropout_494/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer\n"]},{"name":"stdout","output_type":"stream","text":["2/2 [==============================] - 0s 8ms/step - loss: 0.7601 - categorical_accuracy: 0.4750\n","2/2 [==============================] - 0s 8ms/step - loss: 0.6186 - categorical_accuracy: 0.6500\n","2/2 [==============================] - 0s 7ms/step - loss: 0.5973 - categorical_accuracy: 0.6750\n","Mean Val Binary Accuracy: 58.00% (+/- 7.31%)\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_24/3319567254.py:82: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  results_df = results_df.append({\n"]}],"source":["for sbj in range(35, 53):\n","    results_df = CV_giga(sbj, results_df)"]},{"cell_type":"markdown","id":"bade068f","metadata":{"papermill":{"duration":0.081289,"end_time":"2024-10-23T17:20:17.35418","exception":false,"start_time":"2024-10-23T17:20:17.272891","status":"completed"},"tags":[]},"source":["## **Excel que guarda las medias y las desviaciones estándar** "]},{"cell_type":"code","execution_count":12,"id":"68838d07","metadata":{"execution":{"iopub.execute_input":"2024-10-23T17:20:17.518595Z","iopub.status.busy":"2024-10-23T17:20:17.51789Z","iopub.status.idle":"2024-10-23T17:20:17.829659Z","shell.execute_reply":"2024-10-23T17:20:17.828402Z"},"papermill":{"duration":0.396775,"end_time":"2024-10-23T17:20:17.832374","exception":false,"start_time":"2024-10-23T17:20:17.435599","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["    Subject  Mean Accuracy  Standard Deviation\n","0       1.0       0.805000            0.029155\n","1       2.0       0.490000            0.066332\n","2       3.0       0.955000            0.043012\n","3       4.0       0.890000            0.051478\n","4       5.0       0.708333            0.082327\n","5       6.0       0.753175            0.046097\n","6       7.0       0.495833            0.056519\n","7       8.0       0.475000            0.084980\n","8       9.0       0.583333            0.068465\n","9      10.0       0.750000            0.070711\n","10     11.0       0.560000            0.080000\n","11     12.0       0.678487            0.035436\n","12     13.0       0.870000            0.062048\n","13     14.0       0.975000            0.015811\n","14     15.0       0.560729            0.093047\n","15     16.0       0.593333            0.097951\n","16     17.0       0.550000            0.079057\n","17     18.0       0.690000            0.086023\n","18     19.0       0.545567            0.137177\n","19     20.0       0.697794            0.086827\n","20     21.0       0.733974            0.110774\n","21     22.0       0.695000            0.101735\n","22     23.0       0.933846            0.044305\n","23     24.0       0.628590            0.071344\n","24     25.0       0.750000            0.081690\n","25     26.0       0.735000            0.020000\n","26     27.0       0.551351            0.032432\n","27     28.0       0.719487            0.080655\n","28     30.0       0.549667            0.038187\n","29     31.0       0.612564            0.092802\n","30     32.0       0.490000            0.020000\n","31     33.0       0.532179            0.058406\n","32     35.0       0.840000            0.075166\n","33     36.0       0.692308            0.111177\n","34     37.0       0.750000            0.074162\n","35     38.0       0.523887            0.047099\n","36     39.0       0.628205            0.093761\n","37     40.0       0.555000            0.048477\n","38     41.0       0.904615            0.028900\n","39     42.0       0.640000            0.081548\n","40     43.0       0.990000            0.012247\n","41     44.0       0.790000            0.056125\n","42     45.0       0.535000            0.046368\n","43     46.0       0.719681            0.038460\n","44     47.0       0.765992            0.041519\n","45     48.0       0.949872            0.022218\n","46     49.0       0.760324            0.048012\n","47     50.0       0.880000            0.043012\n","48     51.0       0.483941            0.066243\n","49     52.0       0.580000            0.073144\n"]},{"data":{"text/html":["<a href='cross_validation_results_eegnet.xlsx' target='_blank'>cross_validation_results_eegnet.xlsx</a><br>"],"text/plain":["/kaggle/working/cross_validation_results_eegnet.xlsx"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["# Guardar los resultados en un archivo xlsx\n","results_df.to_excel('cross_validation_results_eegnet.xlsx', index=False)\n","\n","# Mostrar el DataFrame final\n","print(results_df)\n","\n","# Generar un enlace de descarga para el archivo xlsx\n","FileLink('cross_validation_results_eegnet.xlsx')"]}],"metadata":{"kaggle":{"accelerator":"nvidiaTeslaT4","dataSources":[{"datasetId":3008205,"sourceId":5175158,"sourceType":"datasetVersion"}],"dockerImageVersionId":30733,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":4387.600756,"end_time":"2024-10-23T17:20:21.260398","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-10-23T16:07:13.659642","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}